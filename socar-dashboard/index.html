<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOCAR Process Optimization Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
        }
        .card {
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        .metric-card {
            text-align: center;
            padding: 20px;
            transition: transform 0.3s ease;
        }
        .metric-card:hover {
            transform: translateY(-5px);
        }
        .metric-value {
            font-size: 2.2rem;
            font-weight: bold;
            margin: 10px 0;
        }
        .nav-tabs {
            border-bottom: 2px solid #dee2e6;
        }
        .nav-tabs .nav-link {
            border: none;
            color: #495057;
            font-size: 1.1rem;
            padding: 0.75rem 1.25rem;
            margin-right: 0.5rem;
            border-radius: 0.5rem 0.5rem 0 0;
        }
        .nav-tabs .nav-link.active {
            font-weight: bold;
            color: #212529;
            background-color: #fff;
            border-bottom: 3px solid #0d6efd;
        }
        .card-header {
            background-color: #f8f9fa;
            font-weight: 600;
            padding: 0.75rem 1.25rem;
        }
        .filter-controls {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .insight-box {
            background-color: #e9f5fe;
            border-left: 4px solid #0d6efd;
            padding: 15px;
            margin-top: 15px;
            border-radius: 0 8px 8px 0;
        }
        .optimization-card {
            height: 100%;
            transition: transform 0.3s ease;
        }
        .optimization-card:hover {
            transform: translateY(-5px);
        }
        .optimization-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }
        footer {
            margin-top: 50px;
            padding: 20px 0;
            background-color: #f1f1f1;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container-fluid p-4">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-md-8">
                <h1 class="display-5">SOCAR Process Optimization Dashboard</h1>
                <p class="lead">Comprehensive analysis of oil, gas, and chemical processing operations</p>
            </div>
            <div class="col-md-4 text-end">
                <img src="https://upload.wikimedia.org/wikipedia/en/thumb/a/a0/SOCAR_logo.svg/1200px-SOCAR_logo.svg.png" alt="SOCAR Logo" height="60" class="mt-2">
            </div>
        </div>
        
        <!-- Key Metrics Row -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card metric-card bg-primary text-white">
                    <div class="card-body">
                        <h5>Potential Savings</h5>
                        <div class="metric-value">8.2M AZN</div>
                        <small>Annual Projection</small>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card metric-card bg-success text-white">
                    <div class="card-body">
                        <h5>Safety Improvement</h5>
                        <div class="metric-value">40%</div>
                        <small>Incident Reduction</small>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card metric-card bg-info text-white">
                    <div class="card-body">
                        <h5>Energy Efficiency</h5>
                        <div class="metric-value">15%</div>
                        <small>Potential Improvement</small>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card metric-card bg-warning text-dark">
                    <div class="card-body">
                        <h5>ROI Timeline</h5>
                        <div class="metric-value">9 Months</div>
                        <small>Average Payback Period</small>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Filter Controls -->
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card filter-controls">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3">
                                <label for="processTypeFilter" class="form-label">Process Type:</label>
                                <select class="form-select" id="processTypeFilter" onchange="filterDashboard()">
                                    <option value="all">All Types</option>
                                    <option value="Neft Emalı">Oil Processing</option>
                                    <option value="Qaz Emalı">Gas Processing</option>
                                    <option value="Kimya Emalı">Chemical Processing</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="processStepFilter" class="form-label">Process Step:</label>
                                <select class="form-select" id="processStepFilter" onchange="filterDashboard()">
                                    <option value="all">All Steps</option>
                                    <option value="Distillə">Distillation</option>
                                    <option value="Katalitik Kraker">Catalytic Cracking</option>
                                    <option value="Kondensasiya">Condensation</option>
                                    <option value="Polimerizasiya">Polymerization</option>
                                    <option value="Nəzarət Krakeri">Control Cracking</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="dateRange" class="form-label">Date Range:</label>
                                <select class="form-select" id="dateRange">
                                    <option value="last30">Last 30 Days</option>
                                    <option value="last90">Last 90 Days</option>
                                    <option value="last180">Last 180 Days</option>
                                    <option value="all" selected>All Time</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">&nbsp;</label>
                                <button class="btn btn-primary w-100" onclick="resetFilters()">
                                    <i class="bi bi-arrow-counterclockwise"></i> Reset Filters
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Tabs for Different Views -->
        <ul class="nav nav-tabs mb-4" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button" role="tab">
                    <i class="bi bi-speedometer2"></i> Process Overview
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="efficiency-tab" data-bs-toggle="tab" data-bs-target="#efficiency" type="button" role="tab">
                    <i class="bi bi-graph-up"></i> Efficiency Analysis
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="safety-tab" data-bs-toggle="tab" data-bs-target="#safety" type="button" role="tab">
                    <i class="bi bi-shield-check"></i> Safety Analysis
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="optimization-tab" data-bs-toggle="tab" data-bs-target="#optimization" type="button" role="tab">
                    <i class="bi bi-gear"></i> Optimization Opportunities
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="roi-tab" data-bs-toggle="tab" data-bs-target="#roi" type="button" role="tab">
                    <i class="bi bi-currency-exchange"></i> ROI Projections
                </button>
            </li>
        </ul>
        
        <!-- Tab Contents -->
        <div class="tab-content" id="myTabContent">
            <!-- Overview Tab -->
            <div class="tab-pane fade show active" id="overview" role="tabpanel">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Process Efficiency Comparison</div>
                            <div class="card-body">
                                <div id="processEfficiencyChart" style="height: 400px;"></div>
                            </div>
                            <div class="card-footer">
                                <div class="insight-box">
                                    <h6><i class="bi bi-lightbulb"></i> Key Insight:</h6>
                                    <p>Oil processing achieves the highest efficiency (95%) but with significant safety tradeoffs. Chemical processing (93.7%) offers better safety outcomes with minimal efficiency sacrifice.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Process Hierarchy and Efficiency</div>
                            <div class="card-body">
                                <div id="processHierarchyChart" style="height: 400px;"></div>
                            </div>
                            <div class="card-footer">
                                <div class="insight-box">
                                    <h6><i class="bi bi-lightbulb"></i> Key Insight:</h6>
                                    <p>Chemical polymerization represents the most efficient process step (98.25%) while gas processing control cracking has the lowest efficiency (89.5%).</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">KPI Dashboard</div>
                            <div class="card-body">
                                <div id="kpiDashboardChart" style="height: 500px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Efficiency Tab -->
            <div class="tab-pane fade" id="efficiency" role="tabpanel">
                <div class="row">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header">Parameter Correlation with Efficiency</div>
                            <div class="card-body">
                                <div id="efficiencyCorrelationChart" style="height: 500px;"></div>
                            </div>
                            <div class="card-footer">
                                <div class="insight-box">
                                    <h6><i class="bi bi-lightbulb"></i> Key Insight:</h6>
                                    <p>Pressure shows the strongest negative correlation with efficiency (-0.39), while processing volume shows a positive correlation (0.30). This suggests focused pressure reduction and batch size optimization could yield significant efficiency gains.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">Catalyst Efficiency Impact</div>
                            <div class="card-body">
                                <div id="catalystEfficiencyChart" style="height: 500px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Energy Consumption vs. Efficiency</div>
                            <div class="card-body">
                                <div id="energyEfficiencyChart" style="height: 400px;"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Process Duration Analysis</div>
                            <div class="card-body">
                                <div id="durationAnalysisChart" style="height: 400px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Safety Tab -->
            <div class="tab-pane fade" id="safety" role="tabpanel">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Energy Consumption vs. Safety Incidents</div>
                            <div class="card-body">
                                <div id="energySafetyChart" style="height: 400px;"></div>
                            </div>
                            <div class="card-footer">
                                <div class="insight-box">
                                    <h6><i class="bi bi-lightbulb"></i> Key Insight:</h6>
                                    <p>A strong correlation exists between energy consumption and safety incidents. Processes consuming over 1.8 kWh/ton show 3x higher incident rates.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Process Step Safety Analysis</div>
                            <div class="card-body">
                                <div id="processStepSafetyChart" style="height: 400px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">Temperature and Pressure Safety Matrix</div>
                            <div class="card-body">
                                <div id="safetyHeatmapChart" style="height: 500px;"></div>
                            </div>
                            <div class="card-footer">
                                <div class="insight-box">
                                    <h6><i class="bi bi-lightbulb"></i> Key Insight:</h6>
                                    <p>The safest operating zone is at moderate temperatures (150-300°C) and moderate pressures (30-50 bar), where incident rates are close to zero. High temperatures combined with high pressure represent the highest risk zone.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Optimization Opportunities Tab -->
            <div class="tab-pane fade" id="optimization" role="tabpanel">
                <div class="row">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header">Process Improvement Opportunities</div>
                            <div class="card-body">
                                <div id="improvementOpportunitiesChart" style="height: 500px;"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">Process Parameter Optimizer</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label for="processType" class="form-label">Process Type:</label>
                                    <select class="form-select" id="processType">
                                        <option value="Neft Emalı">Oil Processing</option>
                                        <option value="Qaz Emalı">Gas Processing</option>
                                        <option value="Kimya Emalı">Chemical Processing</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="temperature" class="form-label">Temperature (°C): <span id="tempValue">350</span></label>
                                    <input type="range" class="form-range" id="temperature" min="100" max="550" value="350">
                                </div>
                                <div class="mb-3">
                                    <label for="pressure" class="form-label">Pressure (bar): <span id="pressureValue">15</span></label>
                                    <input type="range" class="form-range" id="pressure" min="5" max="50" value="15">
                                </div>
                                <div class="mb-3">
                                    <label for="duration" class="form-label">Duration (hours): <span id="durationValue">12</span></label>
                                    <input type="range" class="form-range" id="duration" min="6" max="18" value="12">
                                </div>
                                <button class="btn btn-primary w-100" onclick="predictOutcomes()">Simulate Process</button>
                                
                                <div id="optimizerResults" class="mt-3"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-md-12">
                        <h4>Strategic Optimization Areas</h4>
                    </div>
                    <div class="col-md-4">
                        <div class="card optimization-card">
                            <div class="card-body text-center">
                                <div class="optimization-icon text-primary">
                                    <i class="bi bi-lightning-charge"></i>
                                </div>
                                <h5 class="card-title">Energy Efficiency Enhancement</h5>
                                <p class="card-text">Target the 20% of processes with highest energy-per-ton metrics for optimization.</p>
                                <ul class="text-start">
                                    <li>Implement precision control systems</li>
                                    <li>Reduce energy fluctuations</li>
                                    <li>Redesign heat recovery systems</li>
                                </ul>
                                <div class="text-success mt-3">
                                    <strong>Potential Impact: 15% energy reduction</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card optimization-card">
                            <div class="card-body text-center">
                                <div class="optimization-icon text-success">
                                    <i class="bi bi-gem"></i>
                                </div>
                                <h5 class="card-title">Catalyst Transformation</h5>
                                <p class="card-text">Replace high-risk catalysts with safer, more efficient alternatives.</p>
                                <ul class="text-start">
                                    <li>Prioritize zirconium-based catalysts</li>
                                    <li>Implement silica-aluminum alternatives</li>
                                    <li>Enhance catalyst handling procedures</li>
                                </ul>
                                <div class="text-success mt-3">
                                    <strong>Potential Impact: 40% incident reduction</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card optimization-card">
                            <div class="card-body text-center">
                                <div class="optimization-icon text-info">
                                    <i class="bi bi-sliders"></i>
                                </div>
                                <h5 class="card-title">Parameter Standardization</h5>
                                <p class="card-text">Transfer optimal operating parameters from high-performance processes.</p>
                                <ul class="text-start">
                                    <li>Standardize temperature controls</li>
                                    <li>Implement pressure optimization</li>
                                    <li>Adjust process durations</li>
                                </ul>
                                <div class="text-success mt-3">
                                    <strong>Potential Impact: 8% efficiency increase</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ROI Projections Tab -->
            <div class="tab-pane fade" id="roi" role="tabpanel">
                <div class="row">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header">Annual Cost Savings Projection</div>
                            <div class="card-body">
                                <div id="roiWaterfallChart" style="height: 500px;"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">ROI Calculator</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label for="investmentAmount" class="form-label">Investment Amount (AZN):</label>
                                    <input type="number" class="form-control" id="investmentAmount" value="1000000">
                                </div>
                                <div class="mb-3">
                                    <label for="efficiencyImprovement" class="form-label">Efficiency Improvement (%):</label>
                                    <input type="range" class="form-range" id="efficiencyImprovement" min="1" max="20" value="5">
                                    <div id="efficiencyValue">5%</div>
                                </div>
                                <div class="mb-3">
                                    <label for="processVolume" class="form-label">Annual Processing Volume (tons):</label>
                                    <input type="number" class="form-control" id="processVolume" value="200000">
                                </div>
                                <button class="btn btn-primary w-100" onclick="calculateROI()">Calculate ROI</button>
                                <div id="roiResult" class="mt-3"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">ROI by Process Type</div>
                            <div class="card-body">
                                <div id="roiByProcessChart" style="height: 400px;"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">Implementation Timeline</div>
                            <div class="card-body">
                                <div id="implementationTimelineChart" style="height: 400px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <p>SOCAR Process Analysis Dashboard | Developed by Ismat Samadov | March 2025</p>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- JavaScript to load the charts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Function to load JSON chart data and render
        async function loadChart(elementId, jsonPath) {
            try {
                const response = await fetch(jsonPath);
                const chartData = await response.json();
                Plotly.newPlot(elementId, chartData.data, chartData.layout);
            } catch (error) {
                console.error(`Error loading chart ${jsonPath}:`, error);
                document.getElementById(elementId).innerHTML = 
                    `<div class="alert alert-danger">Error loading chart data</div>`;
            }
        }
        
        // Update display values as sliders change
        document.addEventListener('DOMContentLoaded', function() {
            const sliders = document.querySelectorAll('.form-range');
            if (sliders) {
                sliders.forEach(slider => {
                    slider.addEventListener('input', function() {
                        document.getElementById(this.id + 'Value').textContent = this.value + 
                            (this.id === 'efficiencyImprovement' ? '%' : '');
                    });
                });
            }
            
            // Load all charts
            loadAllCharts();
        });
        
        // Load all charts
        function loadAllCharts() {
            // Overview tab charts
            loadChart('processEfficiencyChart', 'charts/process_efficiency.json');
            loadChart('processHierarchyChart', 'charts/process_hierarchy.json');
            loadChart('kpiDashboardChart', 'charts/kpi_dashboard.json');
            
            // Efficiency tab charts
            loadChart('efficiencyCorrelationChart', 'charts/efficiency_correlation.json');
            loadChart('catalystEfficiencyChart', 'charts/catalyst_matrix.json');
            loadChart('energyEfficiencyChart', 'charts/energy_vs_efficiency.json');
            loadChart('durationAnalysisChart', 'charts/process_duration_comparison.json');
            
            // Safety tab charts
            loadChart('energySafetyChart', 'charts/energy_safety.json');
            loadChart('processStepSafetyChart', 'charts/process_step_safety.json');
            loadChart('safetyHeatmapChart', 'charts/safety_heatmap.json');
            
            // Optimization tab charts
            loadChart('improvementOpportunitiesChart', 'charts/process_improvement_opportunities.json');
            
            // ROI tab charts
            loadChart('roiWaterfallChart', 'charts/roi_waterfall.json');
            loadChart('roiByProcessChart', 'charts/roi_by_process.json');
            
            // Create a basic timeline chart
            createTimelineChart();
        }
        // Add this function after the loadChart function in index.html
        async function loadChartWithFallback(elementId, jsonPath, pngPath) {
            try {
                const response = await fetch(jsonPath);
                if (!response.ok) {
                    throw new Error(`Failed to load ${jsonPath}`);
                }
                const chartData = await response.json();
                Plotly.newPlot(elementId, chartData.data, chartData.layout);
            } catch (error) {
                console.warn(`Falling back to PNG for ${elementId}: ${error.message}`);
                document.getElementById(elementId).innerHTML = 
                    `<img src="${pngPath}" class="img-fluid" alt="Chart visualization">`;
            }
        }

        // Then in the loadAllCharts function, replace some of the loadChart calls:
        function loadAllCharts() {
            // Overview tab charts
            loadChartWithFallback(
                'processEfficiencyChart', 
                'charts/process_efficiency.json', 
                '../charts/process_efficiency_comparison.png'
            );
            // ... other chart loading with fallbacks
        }
        // Filter dashboard based on selections
        function filterDashboard() {
            // In a real implementation, this would update the charts based on filters
            // For demonstration, we'll just show an alert
            const processType = document.getElementById('processTypeFilter').value;
            const processStep = document.getElementById('processStepFilter').value;
            
            alert(`Filter applied: Process Type = ${processType}, Process Step = ${processStep}`);
            
            // The real implementation would reload charts with filtered data
            // or use Plotly's update capabilities to filter existing charts
        }
        
        // Reset all filters
        function resetFilters() {
            document.getElementById('processTypeFilter').value = 'all';
            document.getElementById('processStepFilter').value = 'all';
            document.getElementById('dateRange').value = 'all';
            
            // Reload all charts with unfiltered data
            loadAllCharts();
        }
        
        // Process parameter optimizer
        function predictOutcomes() {
            const processType = document.getElementById('processType').value;
            const temperature = parseInt(document.getElementById('temperature').value);
            const pressure = parseInt(document.getElementById('pressure').value);
            const duration = parseInt(document.getElementById('duration').value);
            
            // Simple efficiency model based on our analysis
            let efficiency = 90;
            let safetyRisk = 50;
            let energyUsage = 1.8;
            
            // Adjust based on temperature
            if (temperature < 200) {
                efficiency -= 5;
                safetyRisk -= 10;
                energyUsage -= 0.2;
            } else if (temperature > 400) {
                efficiency += 2;
                safetyRisk += 40;
                energyUsage += 0.3;
            }
            
            // Adjust based on pressure
            if (pressure < 10) {
                efficiency += 3;
                safetyRisk -= 15;
            } else if (pressure > 30) {
                efficiency -= 2;
                safetyRisk += 30;
            }
            
            // Adjust based on duration
            if (duration < 10) {
                efficiency -= 4;
            } else if (duration > 14) {
                efficiency -= 2;
                safetyRisk += 10;
            }
            
            // Adjust based on process type
            if (processType === 'Neft Emalı') {
                safetyRisk += 20;
                energyUsage += 0.2;
            } else if (processType === 'Kimya Emalı') {
                efficiency += 3;
                safetyRisk -= 10;
            }
            
            // Ensure values are in reasonable ranges
            efficiency = Math.min(Math.max(efficiency, 80), 99);
            safetyRisk = Math.min(Math.max(safetyRisk, 0), 100);
            energyUsage = Math.max(energyUsage, 1.0);
            
            // Calculate cost implications
            const costPerTon = 45 + (energyUsage * 2);
            const incidentRisk = safetyRisk > 70 ? 'High' : safetyRisk > 30 ? 'Medium' : 'Low';
            
            // Generate recommendations
            let recommendation = '';
            
            if (temperature > 400 && safetyRisk > 70) {
                recommendation += '<p><strong>Consider reducing temperature</strong> to improve safety profile.</p>';
            }
            
            if (pressure > 30 && safetyRisk > 60) {
                recommendation += '<p><strong>High pressure operation</strong> increases safety incidents. Consider pressure reduction.</p>';
            }
            
            if (duration > 14 && efficiency < 92) {
                recommendation += '<p><strong>Extended duration</strong> not improving efficiency. Recommend shortening to 12 hours.</p>';
            }
            
            if (efficiency > 94 && safetyRisk < 50) {
                recommendation += '<p><strong>Optimal parameters!</strong> These settings balance efficiency and safety well.</p>';
            }
            
            // Display results
            document.getElementById('optimizerResults').innerHTML = `
                <div class="card">
                    <div class="card-header bg-primary text-white">Predicted Process Outcomes</div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col">
                                <h6>Performance Metrics:</h6>
                                <ul class="list-group mb-3">
                                    <li class="list-group-item d-flex justify-content-between">
                                        <span>Efficiency:</span>
                                        <span class="badge bg-${efficiency > 95 ? 'success' : efficiency > 90 ? 'primary' : 'warning'} rounded-pill">${efficiency.toFixed(1)}%</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between">
                                        <span>Energy Usage:</span>
                                        <span class="badge bg-${energyUsage < 1.5 ? 'success' : energyUsage < 1.8 ? 'primary' : 'warning'} rounded-pill">${energyUsage.toFixed(2)} kWh/ton</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between">
                                        <span>Safety Risk:</span>
                                        <span class="badge bg-${incidentRisk === 'Low' ? 'success' : incidentRisk === 'Medium' ? 'warning' : 'danger'} rounded-pill">${incidentRisk}</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between">
                                        <span>Cost per Ton:</span>
                                        <span>${costPerTon.toFixed(2)} AZN</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <h6>Recommendations:</h6>
                                <div class="alert ${efficiency > 94 && safetyRisk < 50 ? 'alert-success' : 'alert-warning'}">
                                    ${recommendation || '<p>Adjust parameters to see customized recommendations.</p>'}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // ROI calculator functionality
        function calculateROI() {
            const investment = parseFloat(document.getElementById('investmentAmount').value);
            const improvement = parseFloat(document.getElementById('efficiencyImprovement').value);
            const annualProduction = parseFloat(document.getElementById('processVolume').value);
            
            // Calculate annual savings based on efficiency improvement
            const baselineCost = 50; // AZN per ton
            const savingsPerTon = baselineCost * (improvement / 100);
            const annualSavings = annualProduction * savingsPerTon;
            
            // Calculate ROI
            const roi = (annualSavings / investment) * 100;
            const paybackPeriod = investment / annualSavings * 12; // in months
            
            document.getElementById('roiResult').innerHTML = `
                <div class="alert alert-success">
                    <h5>ROI Analysis Results:</h5>
                    <p><strong>Annual Savings:</strong> ${annualSavings.toLocaleString()} AZN</p>
                    <p><strong>Return on Investment:</strong> ${roi.toFixed(2)}%</p>
                    <p><strong>Payback Period:</strong> ${paybackPeriod.toFixed(1)} months</p>
                </div>
            `;
        }
        
        // Create implementation timeline chart
        function createTimelineChart() {
            const milestones = [
                {x: 'Month 1-3', y: ['Energy Audit', 'Process Analysis'], name: 'Phase 1'},
                {x: 'Month 4-6', y: ['Catalyst Testing', 'Parameter Optimization'], name: 'Phase 2'},
                {x: 'Month 7-9', y: ['Retrofit Implementation', 'Training'], name: 'Phase 3'},
                {x: 'Month 10-12', y: ['Full Deployment', 'Performance Monitoring'], name: 'Phase 4'}
            ];
            
            const data = milestones.map(milestone => ({
                x: [milestone.x, milestone.x],
                y: milestone.y,
                type: 'scatter',
                mode: 'markers',
                marker: {
                    symbol: 'circle',
                    size: 16,
                    color: milestone.name === 'Phase 1' ? '#1f77b4' : 
                           milestone.name === 'Phase 2' ? '#ff7f0e' :
                           milestone.name === 'Phase 3' ? '#2ca02c' : '#d62728'
                },
                name: milestone.name
            }));
            
            const layout = {
                title: 'Implementation Timeline',
                xaxis: {
                    type: 'category',
                    title: 'Timeline'
                },
                yaxis: {
                    title: 'Milestone',
                    autorange: true
                },
                height: 400,
                margin: {l: 150, r: 50, t: 50, b: 50}
            };
            
            Plotly.newPlot('implementationTimelineChart', data, layout);
        }
    </script>
</body>
</html>